<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- |
Copyright   : (c) Takayuki Muranushi, 2016
License     : BSD3
Maintainer  : whosekiteneverfly@gmail.com
Stability   : experimental


Provides a interactive printer for printing Unicode characters in ghci REPL. Our design goal is that 'uprint' produces String representations that are valid Haskell 'String' literals and uses as many Unicode printable characters as possible. Hence

@
read . ushow == id
@

see the tests of this package for detailed specifications.

__Example__

With 'print' :

@
$ __ghci__
...
&gt; __[&quot;&#21704;&#26031;&#20811;&#23572;7.6.1&quot;]__
[&quot;\\21704\\26031\\20811\\23572\\&amp;7.6.1&quot;]
&gt;
@

With 'uprint' :

@
$ __ghci -interactive-print=Text.Show.Unicode.uprint Text.Show.Unicode__
...
Ok, modules loaded: Text.Show.Unicode.
&gt; __(&quot;&#1061;&#1086;&#1088;&#1086;&#1096;&#1086;!&quot;,[&quot;&#21704;&#26031;&#20811;&#23572;7.6.1&#30340;&#21147;&#37327;&quot;,&quot;&#24863;&#12376;&#12427;&quot;])__
(&quot;&#1061;&#1086;&#1088;&#1086;&#1096;&#1086;!&quot;,[&quot;&#21704;&#26031;&#20811;&#23572;7.6.1&#30340;&#21147;&#37327;&quot;,&quot;&#24863;&#12376;&#12427;&quot;])
&gt; &quot;&#25913;\\n&#34892;&quot;
&quot;&#25913;\\n&#34892;&quot;
@

You can make 'uprint' the default interactive printer in several ways. One is to
@cabal install unicode-show@, and add the following lines to your @~/.ghci@ config file.

@
import qualified Text.Show.Unicode
:set -interactive-print=Text.Show.Unicode.uprint
@

-}</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Show.Unicode</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Show.Unicode.html#ushow"><span class="hs-identifier">ushow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Show.Unicode.html#uprint"><span class="hs-identifier">uprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Show.Unicode.html#ushowWith"><span class="hs-identifier">ushowWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Show.Unicode.html#uprintWith"><span class="hs-identifier">uprintWith</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isPrint</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.ParserCombinators.ReadP</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Read.Lex</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lexChar</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- Represents a replaced character using its literal form and its escaped form.</span><span>
</span><span id="line-58"></span><span class="hs-keyword">type</span><span> </span><span id="Replacement"><span class="annot"><a href="Text.Show.Unicode.html#Replacement"><span class="hs-identifier hs-var">Replacement</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | Parse one Haskell character literal expression from a 'String' produced by 'show', and</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">--  * If the found char satisfies the predicate, replace the literal string with the character itself.</span><span>
</span><span id="line-63"></span><span class="hs-comment">--  * Otherwise, leave the string as it was.</span><span>
</span><span id="line-64"></span><span class="hs-comment">--  * Note that special delimiter sequence &quot;\&amp;&quot; may appear in a string. c.f.  &lt;https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-200002.6 Section 2.6 of the Haskell 2010 specification&gt;.</span><span>
</span><span id="line-65"></span><span class="annot"><a href="Text.Show.Unicode.html#recoverChar"><span class="hs-identifier hs-type">recoverChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><a href="Text.Show.Unicode.html#Replacement"><span class="hs-identifier hs-type">Replacement</span></a></span><span>
</span><span id="line-66"></span><span id="recoverChar"><span class="annot"><span class="annottext">recoverChar :: (Char -&gt; Bool) -&gt; ReadP Replacement
</span><a href="Text.Show.Unicode.html#recoverChar"><span class="hs-identifier hs-var hs-var">recoverChar</span></a></span></span><span> </span><span id="local-6989586621679024250"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679024250"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, Char) -&gt; Replacement
</span><a href="#local-6989586621679024249"><span class="hs-identifier hs-var">represent</span></a></span><span> </span><span class="annot"><span class="annottext">((String, Char) -&gt; Replacement)
-&gt; ReadP (String, Char) -&gt; ReadP Replacement
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP Char -&gt; ReadP (String, Char)
forall a. ReadP a -&gt; ReadP (String, a)
</span><span class="hs-identifier hs-var">gather</span></span><span> </span><span class="annot"><span class="annottext">ReadP Char
</span><span class="hs-identifier hs-var">lexChar</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadP Replacement -&gt; ReadP Replacement -&gt; ReadP Replacement
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\&amp;&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&amp;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Replacement -&gt; ReadP String -&gt; ReadP Replacement
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ReadP String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\&amp;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="#local-6989586621679024249"><span class="hs-identifier hs-type">represent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Show.Unicode.html#Replacement"><span class="hs-identifier hs-type">Replacement</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span id="local-6989586621679024249"><span class="annot"><span class="annottext">represent :: (String, Char) -&gt; Replacement
</span><a href="#local-6989586621679024249"><span class="hs-identifier hs-var hs-var">represent</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679024244"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679024244"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679024243"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679024243"><span class="hs-identifier hs-var">lc</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679024250"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679024243"><span class="hs-identifier hs-var">lc</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679024244"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679024243"><span class="hs-identifier hs-var">lc</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679024244"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679024244"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | Show the input, and then replace Haskell character literals</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- with the character it represents, for any Unicode printable characters except backslash, single and double quotation marks.</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- If something fails, fallback to standard 'show'.</span><span>
</span><span id="line-76"></span><span id="local-6989586621679024271"><span class="annot"><a href="Text.Show.Unicode.html#ushow"><span class="hs-identifier hs-type">ushow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679024271"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679024271"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-77"></span><span id="ushow"><span class="annot"><span class="annottext">ushow :: a -&gt; String
</span><a href="Text.Show.Unicode.html#ushow"><span class="hs-identifier hs-var hs-var">ushow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; a -&gt; String
forall a. Show a =&gt; (Char -&gt; Bool) -&gt; a -&gt; String
</span><a href="Text.Show.Unicode.html#ushowWith"><span class="hs-identifier hs-var">ushowWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679024242"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679024242"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isPrint</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679024242"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679024242"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\\'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\&quot;'</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | A version of 'print' that uses 'ushow'.</span><span>
</span><span id="line-80"></span><span id="local-6989586621679024238"><span class="annot"><a href="Text.Show.Unicode.html#uprint"><span class="hs-identifier hs-type">uprint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679024238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679024238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-81"></span><span id="uprint"><span class="annot"><span class="annottext">uprint :: a -&gt; IO ()
</span><a href="Text.Show.Unicode.html#uprint"><span class="hs-identifier hs-var hs-var">uprint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; (a -&gt; String) -&gt; a -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="Text.Show.Unicode.html#ushow"><span class="hs-identifier hs-var">ushow</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | Show the input, and then replace character literals</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- with the character itself, for characters that satisfy the given predicate.</span><span>
</span><span id="line-85"></span><span id="local-6989586621679024278"><span class="annot"><a href="Text.Show.Unicode.html#ushowWith"><span class="hs-identifier hs-type">ushowWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679024278"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679024278"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-86"></span><span id="ushowWith"><span class="annot"><span class="annottext">ushowWith :: (Char -&gt; Bool) -&gt; a -&gt; String
</span><a href="Text.Show.Unicode.html#ushowWith"><span class="hs-identifier hs-var hs-var">ushowWith</span></a></span></span><span> </span><span id="local-6989586621679024235"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679024235"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679024234"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679024234"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Replacement -&gt; [([Replacement], String)] -&gt; String
</span><a href="#local-6989586621679024233"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([([Replacement], String)] -&gt; String)
-&gt; [([Replacement], String)] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ReadP [Replacement] -&gt; ReadS [Replacement]
forall a. ReadP a -&gt; ReadS a
</span><span class="hs-identifier hs-var">readP_to_S</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP Replacement -&gt; ReadP [Replacement]
forall a. ReadP a -&gt; ReadP [a]
</span><span class="hs-identifier hs-var">many</span></span><span> </span><span class="annot"><span class="annottext">(ReadP Replacement -&gt; ReadP [Replacement])
-&gt; ReadP Replacement -&gt; ReadP [Replacement]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP Replacement
</span><a href="Text.Show.Unicode.html#recoverChar"><span class="hs-identifier hs-var">recoverChar</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679024235"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679024234"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="#local-6989586621679024233"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Show.Unicode.html#Replacement"><span class="hs-identifier hs-type">Replacement</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Text.Show.Unicode.html#Replacement"><span class="hs-identifier hs-type">Replacement</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621679024233"><span class="annot"><span class="annottext">go :: Replacement -&gt; [([Replacement], String)] -&gt; String
</span><a href="#local-6989586621679024233"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Replacement
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="#local-6989586621679024233"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Replacement
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[([Replacement], String)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="#local-6989586621679024233"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Replacement
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679024229"><span class="annot"><span class="annottext">[Replacement]
</span><a href="#local-6989586621679024229"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[([Replacement], String)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Replacement -&gt; String
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Replacement -&gt; String) -&gt; Replacement -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Replacement] -&gt; Replacement
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Replacement]
</span><a href="#local-6989586621679024229"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="#local-6989586621679024233"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Replacement
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Replacement]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679024227"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679024227"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679024227"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="#local-6989586621679024233"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679024226"><span class="annot"><span class="annottext">Replacement
</span><a href="#local-6989586621679024226"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679024225"><span class="annot"><span class="annottext">[([Replacement], String)]
</span><a href="#local-6989586621679024225"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Replacement -&gt; [([Replacement], String)] -&gt; String
</span><a href="#local-6989586621679024233"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Replacement
</span><a href="#local-6989586621679024226"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">[([Replacement], String)]
</span><a href="#local-6989586621679024225"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="#local-6989586621679024233"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Replacement
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679024224"><span class="annot"><span class="annottext">[Replacement]
</span><a href="#local-6989586621679024224"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679024223"><span class="annot"><span class="annottext">[([Replacement], String)]
</span><a href="#local-6989586621679024223"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679024222"><span class="annot"><span class="annottext">r :: Replacement
</span><a href="#local-6989586621679024222"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Replacement] -&gt; Replacement
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Replacement]
</span><a href="#local-6989586621679024224"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Replacement -&gt; String
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Replacement
</span><a href="#local-6989586621679024222"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Replacement -&gt; [([Replacement], String)] -&gt; String
</span><a href="#local-6989586621679024233"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Replacement
</span><a href="#local-6989586621679024222"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[([Replacement], String)]
</span><a href="#local-6989586621679024223"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | A version of 'print' that uses 'ushowWith'.</span><span>
</span><span id="line-97"></span><span id="local-6989586621679024221"><span class="annot"><a href="Text.Show.Unicode.html#uprintWith"><span class="hs-identifier hs-type">uprintWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679024221"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679024221"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-98"></span><span id="uprintWith"><span class="annot"><span class="annottext">uprintWith :: (Char -&gt; Bool) -&gt; a -&gt; IO ()
</span><a href="Text.Show.Unicode.html#uprintWith"><span class="hs-identifier hs-var hs-var">uprintWith</span></a></span></span><span> </span><span id="local-6989586621679024220"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679024220"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; (a -&gt; String) -&gt; a -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; a -&gt; String
forall a. Show a =&gt; (Char -&gt; Bool) -&gt; a -&gt; String
</span><a href="Text.Show.Unicode.html#ushowWith"><span class="hs-identifier hs-var">ushowWith</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679024220"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-99"></span></pre></body></html>